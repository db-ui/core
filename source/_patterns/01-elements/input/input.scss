@charset "utf-8";

@import "input.variables";
@import "../form-elements";

.elm-input {
	@extend %form-element;

	// font-size: to-rem($pxValue: 16);
	// line-height: to-rem($pxValue: 24);

	@include input--sizes();
	@extend %size-m; // default

	// color: $input---color;

	width: 100%;
	max-width: 100%;
	//height: to-rem($pxValue: 40);

	// padding: $db-spacing-s $db-spacing-m;
	//&:not(:placeholder-shown) {
	// padding-top: to-rem($pxValue: 16);
	// padding-bottom: 0;
	//}

	// ### Size variations
	&[data-size="xs"] {
		@extend %size-xs;
	}

	&[data-size="s"] {
		@extend %size-s;
	}

	&[data-size="m"] {
		@extend %size-m;
	}

	&[data-size="l"] {
		@extend %size-l;
	}

	&[data-size="xl"] {
		@extend %size-xl;
	}

	// * TODO: to get evaluated
	// display: inline-flex;
	// align-items: center;
	// justify-content: flex-start;
	// max-width: 100%;

	// TODO: Evaluate whether those could get moved to ../_form-elements.scss
	&:focus,
	&:not(:placeholder-shown) {
		&:not(:disabled) {
			+ .elm-label {
				@include input-label-translation(m);
			}

			&[data-size="xs"] + .elm-label {
				@include input-label-translation(xs);
			}

			&[data-size="s"] + .elm-label {
				@include input-label-translation(s);
			}

			&[data-size="m"] + .elm-label {
				@include input-label-translation(m);
			}

			&[data-size="l"] + .elm-label {
				@include input-label-translation(l);
			}

			&[data-size="xl"] + .elm-label {
				@include input-label-translation(xl);
			}
		}
	}

	// TODO: Evaluate whether those could get moved to ../_form-elements.scss
	&:disabled,
	fieldset:disabled & {
		&,
		& + .elm-label {
			// Decided against cursor: not-allowed, compare to e.g. https://phabricator.wikimedia.org/T121960
			opacity: 0.4;
		}
	}

	&[type="color"],
	&[type="date"],
	&[type="datetime-local"],
	&[type="email"],
	&[type="month"],
	&[type="number"],
	&[type="password"],
	:where(:not(.cmp-sitesearch)) > &[type="search"],
	&[type="tel"],
	&[type="text"],
	&[type="time"],
	&[type="url"],
	&[type="week"] {
		// TODO: Evaluate whether those could get moved to ../_form-elements.scss
		// Semitransparent is the default style
		@at-root :where(#{&}) {
			@extend %form-element-semitransparent;
		}

		// Floating labels
		margin-top: to-rem($pxValue: 16);

		&:not([type="date"]):not([type="datetime-local"]):not([type="month"]):not([type="time"]):not([type="week"])
			+ .elm-label {
			// position: absolute;
			// left: calc(#{to-em($pxValue: 10)} - 1px);

			// transition: opacity, transform 250ms;
			// Adopted by https://www.heise.de/developer/artikel/a11y-Reduced-Motion-4356171.html
			@media (prefers-reduced-motion: reduce) {
				transition-duration: 0.01s !important;
			}
		}
		& + .elm-label {
			// font-size: to-rem($pxValue: 14);
			display: block;
			pointer-events: none;
			transform-origin: left;
			// color: $db-color-cool-gray-500;

			@include input-label-size(m);

			// transform: translate($db-spacing-s, -#{to-rem($pxValue: 16 + 14)});
			// margin-bottom: -#{to-rem($pxValue: 18)};

			& + .description {
				margin-top: -1.5rem;
			}
		}
		// &[placeholder] {
		// 	&:placeholder-shown {
		// 		& + label {
		// 			// opacity: 0;
		// 		}
		// 	}
		// }

		&::placeholder {
			//color: $db-color-cool-gray-500;
			opacity: 0;
			//font-size: to-rem($pxValue: 14);
		}

		&:focus {
			&::placeholder {
				opacity: 0.5;
			}
		}

		// TODO: Evaluate whether those could get moved to ../_form-elements.scss
		// Validation
		&:required {
			&:valid:not([aria-invalid]) {
				//--formElement---borderColor: #{$db-color-green-600};
			}
			&:invalid {
				&:not(:placeholder-shown) {
					@extend %db-bg-critical-transparent-semi;

					& + .elm-label {
						color: $db-colors-critical-on-bg-enabled;
					}
				}
			}
		}
		&[aria-invalid="true"] {
			--formElement---borderColor: #{$db-color-red-500};
		}

		// ### variations
		&[data-variant="error"] {
			@extend %db-bg-critical-transparent-semi;

			& + .elm-label {
				color: $db-colors-critical-on-bg-enabled;
			}

			& ~ .description {
				@extend %db-text-critical;
				display: flex;
				justify-content: space-between;
				max-width: 30rem;

				&::after {
					content: " ";
					position: relative;
					display: block;
					width: 20px;
					height: 20px;
					background-color: aquamarine;
					top: -2rem;
					@include icon(glyph(error-triangle), 20, "filled");
				}
			}
		}
		&[data-variant="warning"] {
			@extend %db-bg-warning-transparent-semi;

			& + .elm-label {
				color: $db-colors-warning-on-bg-enabled;
			}

			& ~ .description {
				@extend %db-text-warning;
			}
		}
		&[data-variant="success"] {
			@extend %db-bg-success-transparent-semi;

			& + .elm-label {
				color: $db-colors-success-on-bg-enabled;
			}

			& ~ .description {
				@extend %db-text-success;
			}
		}
		&[data-variant="information"] {
			@extend %db-bg-information-transparent-semi;

			& + .elm-label {
				color: $db-colors-information-on-bg-enabled;
			}

			& ~ .description {
				@extend %db-text-information;
			}
		}

		&[data-size="xs"] {
			& + .elm-label {
				@include input-label-size(xs);
			}
		}

		&[data-size="s"] {
			& + .elm-label {
				@include input-label-size(s);
			}
		}

		&[data-size="m"] {
			& + .elm-label {
				@include input-label-size(m);
			}
		}

		&[data-size="l"] {
			& + .elm-label {
				@include input-label-size(l);
			}
		}

		&[data-size="xl"] {
			& + .elm-label {
				@include input-label-size(xl);
			}
		}
	}

	&[type="search"] {
		background: var(
				--db-ic-search-24,
				url(#{$icons-path}functional/images/action/db_ic_search_24.svg)
			)
			no-repeat to-rem($pxValue: 6) to-rem($pxValue: 12);
		background-size: to-rem($pxValue: 19);
		padding-left: to-rem($pxValue: 32);

		:not(.cmp-sitesearch) > & {
			@extend %form-element-semitransparent;

			& + .elm-label {
				margin-left: to-rem($pxValue: 16);
			}
		}
	}
}
